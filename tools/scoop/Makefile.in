#

VERSION = @PACKAGE_VERSION@
MSI64   = Gauche-mingw-$(VERSION)-64bit.msi
MSI32   = Gauche-mingw-$(VERSION)-32bit.msi

TARGET = gauche.json

GOSH = @BUILD_GOSH@

all: $(TARGET)

.PHONY: all clean distclean

$(TARGET): make-scoop-manifesto.scm
	$(GOSH) $< --version=$(VERSION) --msi64=$(MSI64) --msi32=$(MSI32) > $@
	emacs --batch --file=$@ --load=json --funcall=json-pretty-print-buffer --funcall=save-buffer

clean:
	rm -f $(TARGET)

distclean: clean
	rm -f Makefile
